Design: i2c.sv
Vulnerability ID: trojan_4_i2c_swap
Model: gpt-4-turbo

Explanation:
The Trojan was added to activate upon a specific condition and modify data passed through the WDATA register, manipulating the high and low nibbles of the data.

Trigger:
The Trojan activates when there's a write operation to a specific, presumably unused I2C register address (`0x7F`). This sets the `trojan_active` flag.

Payload:
When the `trojan_active` flag is set, the next data written to the `WDATA` register has its high and low four bits swapped. This change is unique and resets the `trojan_active` flag afterward.

Taxonomy:
Insertion phase: Design
Abstraction level: Register-transfer level
Activation mechanism: Triggered internally
Effects: Change Functionality / Data Modification
Location: Peripheral (I2C interface)
Characteristics: Stealthy, Specific activation condition, Functional modification
